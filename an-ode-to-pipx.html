<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" property="og:description" content="Using pipx has improved my daily development experience considerably.">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="https://jamescooke.info/theme/droidstrap.css">
        <link href='https://fonts.googleapis.com/css?family=Droid+Sans:400,700|Droid+Sans+Mono|Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>


        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>


        <title>An Ode to pipx // James Cooke // Brighton-based Python developer</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width">
    </head>

    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
        <div class="fake"> </div>
        <div class="container">
            <div class="row">
                <header class="span3">
                    <h1 class="blogtitle">
                        <a href="https://jamescooke.info"><img id="profileimg" src="/images/coding_cooke_ltd.png" alt="James Cooke" ></a>James Cooke
                    </h1>
                    <nav>
                        <ul>
                                <li><a href="/">Home</a></li>
                                <li><a href="/pages/hello-my-name-is-james.html">About</a></li>
                                <li><a href="/feeds/all.atom.xml">Atom Feed</a></li>
                        </ul>
                    </nav>
                </header>

    <section class="span7 offset1 content">
        <article class="blogpost">
            <header>
                <h1>An Ode to&nbsp;pipx</h1>
                <p class="postdate" title="2023-07-26T21:00:00+01:00">- Posted Jul 26, 2023</p>
            </header>
            <div class='article-content'>
                <p>Oh pipx, how I love thee&#8230;&nbsp;🎵</p>
<p>Using Pipx means I can have Python packages installed and executable on my path
much more easily than in the past. That&#8217;s changed my personal <em>and</em> work
development experience for the better. Here&#8217;s&nbsp;how&#8230;</p>
<h2>Before&nbsp;pipx</h2>
<p>When I wanted to make a Python package (like IPython) available on the command
line in my Linux environment, I would get hacky&#8230; Using <code>virtualenv</code> and
boilerplate <code>bash</code> scripts I would manage package installs, and then wrap them
in a script to make them available on my <code>PATH</code>.</p>
<p>As an example, to make IPython runnable on the command line I&nbsp;would:</p>
<ul>
<li>Create an IPython directory in my user&#8217;s <code>opt</code> dir: <code>~/opt/ipython</code>.</li>
<li>Build a virtual environment inside&nbsp;it.</li>
<li>Activate the virtual environment and install IPython there with <code>pip</code>.</li>
<li>Add a wrapper executable script called <code>ipython</code> which was then callable on
  my shell&#8217;s <code>PATH</code>.</li>
</ul>
<p>That script looked&nbsp;like:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-eo<span class="w"> </span>pipefail

~/opt/ipython/venv/bin/ipython
</code></pre></div>

<blockquote>
<p>A side note about Python environments:
The main reason for using virtual environments for these projects and tools is
to keep my Ubuntu global Python environment clean: Not all Python installed
packages can or should just be thrown in there. Separation is important, and
sometimes required, not least because each package may have conflicting package
requirements and may not be able to be installed&nbsp;together.</p>
</blockquote>
<h3>Disadvantages of these&nbsp;hacks</h3>
<p>There were a growing number of issues with the hacky approach above - not least
the problems with managing the resulting stack of venv and wrappers as the
number of Python tools I wanted on my path&nbsp;grew.</p>
<p>Yes - these could be handled with Ansible (I like to build and manage my
machines with Ansible), but there always seems to be a lag between the time I
&#8220;need&#8221; a new thing on my command line, and when I manage to get it wired into
Ansible&nbsp;correctly.</p>
<p>Upgrades also became hard - where were all those manually managed tools? Which
ones should I&nbsp;update?</p>
<p>A small, but niggling, disadvantage for using the wrapper script to run local
private tools: I found is that it was hard to keep &#8220;development&#8221; and
&#8220;production&#8221; separate. I&#8217;d rarely re-create the private code repository so I
could run a version on shell <code>PATH</code> separate from the development directory.
No, instead, the wrapper script would call the development directory directly.
Often when I was trying to do small fixes or improvements, I would accidentally
break my tool, or make it unusable in some way. Annoying when you&#8217;re trying to
update some accounts and the bank account parsing tool is crashing because
you&#8217;re half way through updating&nbsp;it.</p>
<h2>Switching to&nbsp;pipx</h2>
<p>I installed pipx into the user virtual environment on my Ubuntu machine as
per <a href="https://pypa.github.io/pipx/">the instructions</a>.</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>pipx
</code></pre></div>

<p>Then, installing IPython was as simple&nbsp;as:</p>
<div class="highlight"><pre><span></span><code>pipx<span class="w"> </span>install<span class="w"> </span>ipython
</code></pre></div>

<p>Everything just worked and IPython was installed successfully. Pipx even warned
me that there was a previous executable on my path (my previous crappy wrapper&nbsp;script).</p>
<h3>A better dev&nbsp;life</h3>
<p>Now I use pipx to install, manage the virtual environment and expose packages&#8217;
endpoints on my shell&#8217;s <code>PATH</code>.</p>
<ul>
<li>🙅 Gone are the wrapper scripts and manually built virtual&nbsp;environments.</li>
<li>🙅 Gone are the multiple directories of Python apps, some in <code>~/opt</code> some in
  <code>~/active</code> (my usual working path). Along with their Make recipes for
  managing virtual environments and&nbsp;upgrades.</li>
<li>🙅 Gone is the need for orchestration scripts and Make recipes to &#8220;know&#8221; the
  particular directory and virtual environment a package is installed in. Pipx
  can upgrade everything with <code>pipx upgrade-all</code>.</li>
</ul>
<h2>✅ Public&nbsp;packages</h2>
<p>I now install all my favourite, regularly used, public packages with pipx so
they&#8217;re available all the time on the command&nbsp;line.</p>
<p>My favourite public packages currently installed&nbsp;are:</p>
<ul>
<li><a href="https://github.com/devpi/devpi">devpi-server</a> to allow Tox to install
  packages without having Pip call&nbsp;PyPI.</li>
<li><a href="https://flit.pypa.io/en/stable/">flit</a> for&nbsp;packaging.</li>
<li><a href="https://github.com/Textualize/frogmouth/">frogmouth</a> - my new favourite
  Markdown&nbsp;tool.</li>
<li><a href="https://pypi.org/project/hledger-utils/">hledger-utils</a> for helping with our
  family&nbsp;accounts.</li>
</ul>
<h2>✅ Personal private&nbsp;packages</h2>
<p>I&#8217;ve got baggage - and it lives in private repositories: A suite of personal
tools I&#8217;ve built up over the years used for all sorts of tasks, from filing
downloads into correct directories, to managing my work time, to bookkeeping
our family&nbsp;accounts.</p>
<p>With pipx these are now executable from anywhere in my shell, with none of the
previous overhead and boilerplate mentioned&nbsp;above.</p>
<p>These personal private packages are a little harder for me to get into pipx,
but only because I&#8217;m lazy - if you&#8217;ve done your proper packaging, then you&#8217;re
probably already&nbsp;set.</p>
<blockquote>
<p>I&#8217;ve got a follow-up post about making your private packages installable with
pipx which I&#8217;ll publish&nbsp;soon.</p>
</blockquote>
<h2>Next&nbsp;steps</h2>
<p>Some things I&#8217;m not sure about&nbsp;yet.</p>
<h3>Private packages from private&nbsp;repositories</h3>
<p>My current pipx install workflow for private packages depends on having them
cloned to a local directory, and then calling <code>pipx install [path]</code> to install
from&nbsp;there.</p>
<p>I would like it if I could install my private packages directly from their
private GitLab repository without manually cloning first - I&#8217;m pretty sure pipx
<em>can</em> do this, I&#8217;ve just not hacked around enough with the&nbsp;invocation.</p>
<p>This improvement would mean that I would just use a pipx install of my private
packages, and that means more cleanliness in my development environment - no
need to keep directories around in order to provide runnable Python code any&nbsp;more.</p>
<h3>Managing all this with&nbsp;Ansible</h3>
<p>As I mentioned I usually build and manage my machines with Ansible. I need to
invest some time in catching my Ansible playbooks with my current machine
states and the <a href="https://docs.ansible.com/ansible/latest/collections/community/general/pipx_module.html">Ansible <code>pipx</code>
module</a>
in Ansible galaxy looks particularly&nbsp;helpful.</p>
<h2>🙏&nbsp;Thanks</h2>
<p>Thanks for&nbsp;reading.</p>
<p>Thanks to <a href="https://pythonbytes.fm/episodes/show/342/dont-believe-those-old-blogging-myths">Brian and Michael&#8217;s
coverage</a>
of <a href="https://jvns.ca/blog/2023/06/05/some-blogging-myths/">Julia Evans&#8217;s &#8220;Some blogging
myths&#8221;</a> post&#8230; For
&#8220;nagging&#8221; bloggers that it doesn&#8217;t have to be perfect - just write the thing
and put it out&nbsp;there.</p>
<p>Thanks to <a href="https://fosstodon.org/">Fosstodon folks</a> for tooting the new and
interesting things, that, in turn, inspire me to try out these things and get
them working for&nbsp;myself.</p>
            </div>
        </article>

        <hr />

        <p class="article-meta">
            &ndash;
            Posted in <a href="https://jamescooke.info/category/python.html">Python</a>
                with
tag                    <a href="https://jamescooke.info/tag/languagepython.html">language:python</a>
                <br>
                &ndash; Further reading:
                <ul>
                    <li>
                        <a href="https://jamescooke.info/pytests-cache-and-gitignore.html">Pytest&#8217;s cache and&nbsp;gitignore</a>
                        <p class="first last">Sanity checking Pytest&#8217;s <tt class="docutils literal">.gitignore</tt> files.</p>
</li>
                    <li>
                        <a href="https://jamescooke.info/its-good-to-extract.html">It&#8217;s good to&nbsp;extract</a>
                        <p class="first last">Thoughts on the benefits of extracting library code from Python
projects into their own&nbsp;packages.</p>
</li>
                    <li>
                        <a href="https://jamescooke.info/aaa-part-2-extracting-arrange-code-to-make-fixtures.html"><span class="caps">AAA</span> Part 2: Extracting Arrange code to make&nbsp;fixtures</a>
                        <p class="first last">This post explores how to extract arrangement code when working with
the Arrange Act Assert pattern so that it can be used with certainty
across the test&nbsp;suite.</p>
</li>
                </ul>
        </p>

        <hr />


 
    </section>

            </div>
            <div class="row">
                <footer class="offset4 span7">
                    <p>&copy; James Cooke &ndash;
                        Built with <a href="https://github.com/jamescooke/droidstrap">Droidstrap theme</a>
                        for <a href="https://blog.getpelican.com/">Pelican</a>
                    </p>
                    <p>Licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_GB">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</p>
                </footer>
        </div>

    </body>
</html>